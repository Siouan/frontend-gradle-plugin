import org.gradle.api.tasks.testing.logging.TestLogEvent

plugins {
    id 'java-gradle-plugin'
    id 'maven-publish'
    id 'jacoco'
    id 'com.gradle.plugin-publish'
}

repositories {
    jcenter()
    mavenCentral()
}

tasks.named('wrapper') {
    distributionType = Wrapper.DistributionType.ALL
}

tasks.named('test') {
    useJUnitPlatform()
    testLogging {
        exceptionFormat = 'full'
        events = [TestLogEvent.PASSED, TestLogEvent.SKIPPED, TestLogEvent.FAILED, TestLogEvent.STANDARD_OUT,
          TestLogEvent.STANDARD_ERROR]
    }
}

tasks.named('jacocoTestReport') {
    reports {
        xml.enabled = true
        xml.destination file("${buildDir}/reports/jacoco/report.xml")
    }
}

dependencies {
    implementation gradleApi()
    implementation 'org.apache.commons:commons-compress:1.20'

    testImplementation 'org.junit.jupiter:junit-jupiter-api:5.6.1'
    testImplementation 'org.junit.jupiter:junit-jupiter-params:5.6.1'
    testImplementation 'org.mockito:mockito-core:3.3.3'
    testImplementation 'org.mockito:mockito-junit-jupiter:3.3.3'
    testImplementation 'org.assertj:assertj-core:3.15.0'
    testRuntimeOnly 'org.junit.jupiter:junit-jupiter-engine:5.6.1'
}

group 'org.siouan'
version '2.1.1'
description 'Build Node.js, npm, Yarn applications with Gradle.'

java {
    sourceCompatibility = JavaVersion.VERSION_1_8
    targetCompatibility = JavaVersion.VERSION_1_8
}

gradlePlugin {
    plugins {
        frontend {
            id = 'org.siouan.frontend'
            implementationClass = 'org.siouan.frontendgradleplugin.FrontendGradlePlugin'
        }
    }
}

pluginBundle {
    website = 'https://github.com/siouan/frontend-gradle-plugin'
    vcsUrl = 'https://github.com/siouan/frontend-gradle-plugin.git'

    plugins {
        frontend {
            displayName = 'Frontend Gradle plugin'
            description = 'Build Node.js, npm, Yarn applications with Gradle.'
            tags = ['node', 'nodejs', 'npm', 'npx', 'yarn', 'frontend']
        }
    }
}
